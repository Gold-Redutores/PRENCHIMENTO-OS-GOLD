<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Relat√≥rio de Manuten√ß√£o Preventiva - OS Autom√°tica</title>
    <style>
        /* CONFIGURA√á√ïES GERAIS */
        body { font-family: Arial, sans-serif; margin: 20px; color: #003366; }
        .header { text-align: center; border-bottom: 2px solid #ed1c24; padding-bottom: 10px; margin-bottom: 10px; position: relative; }
        .header h2 { margin: 0; font-size: 22px; }
        
        .section { background: #d9d9d9; padding: 5px; margin-top: 15px; font-weight: bold; text-align: center; border: 1px solid #333; text-transform: uppercase; }
        
        /* TABELAS */
        table { width: 100%; border-collapse: collapse; table-layout: fixed; margin-bottom: 0; }
        table, th, td { border: 1px solid #333; }
        td { padding: 6px; font-size: 11px; vertical-align: middle; }
        th { background: #eee; padding: 8px; font-size: 11px; text-align: center; }
        
        /* INPUTS */
        label { font-weight: bold; color: #003366; }
        input[type="text"], input[type="number"], textarea { width: 98%; border: none; outline: none; background: transparent; font-size: 11px; color: #000; font-family: Arial, sans-serif; }
        textarea { resize: none; overflow: hidden; }

        /* GALERIA DE FOTOS */
        .foto-container { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
        .foto-item { border: 1px solid #333; padding: 5px; text-align: center; background: #fff; }
        .foto-preview { max-width: 100%; max-height: 250px; margin-bottom: 5px; display: block; margin-left: auto; margin-right: auto; }
        .obs-foto { width: 100%; border-top: 1px solid #ccc !important; padding-top: 5px; font-style: italic; color: #333; }

        /* SE√á√ÉO CONCLUS√ïES */
        .conclusoes-title { color: #003366; border-bottom: 1px solid #003366; margin-top: 20px; font-size: 18px; font-weight: normal; padding-bottom: 5px; }
        .conclusoes-texto { font-size: 13px; color: #003366; line-height: 1.5; margin-top: 10px; text-align: justify; }

        /* TOTAIS E BOT√ïES */
        .total-row { font-weight: bold; background-color: #f2f2f2; font-size: 13px; }
        #total-horas { color: #ed1c24; font-size: 14px; font-weight: bold; }
        .no-print { margin-top: 20px; text-align: right; }
        button { padding: 10px 25px; background: #003366; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; }
        
        @media print { 
            .no-print, input[type="file"] { display: none; } 
            .foto-item { page-break-inside: avoid; }
            body { margin: 10px; }
            /* Garante que o placeholder n√£o apare√ßa na impress√£o se estiver vazio */
            textarea::placeholder { color: transparent; }
        }
    </style>
</head>
<body>

    <div class="header">
        <h2>RELAT√ìRIO DE MANUTEN√á√ÉO PREVENTIVA</h2>
        <div style="margin-top: 10px;">
            <label>N¬∫ ORDEM DE SERVI√áO: </label>
            <input type="text" style="width: 150px; border-bottom: 1px solid #333; text-align: center;" placeholder="Ex: 5422">
        </div>
    </div>

    <div class="section">DADOS DO CLIENTE E EQUIPAMENTO</div>
    <table>
        <tr>
            <td colspan="2"><label>Cliente: </label> <input type="text" placeholder="Ex: GOLD REDUTORES"></td>
            <td colspan="2"><label>Data: </label> <span id="data-atual" style="color: #000; font-weight: bold;"></span></td>
        </tr>
        <tr>
            <td><label>Redutor:</label> <input type="text"  placeholder="Ex: X3KS160/HU/B"></td>
            <td><label>Redu√ß√£o:</label> <input type="text" placeholder="Ex: 15,53"></td>
            <td colspan="2"><label>S√©rie:</label> <input type="text" placeholder="Ex: 707805785805000119"></td>
        </tr>
    </table>

    <div class="section">AN√ÅLISES FOTOGR√ÅFICAS</div>
    <div class="no-print" style="padding: 10px; background: #f9f9f9; border: 1px dashed #ccc; margin-top: 5px;">
        <label>üì∏ Selecionar Fotos do Redutor: </label>
        <input type="file" accept="image/*" multiple onchange="previewFotos(event)">
    </div>
    <div id="container-fotos" class="foto-container"></div>

    <div class="section">PE√áAS NECESS√ÅRIAS PARA EXECU√á√ÉO</div>
    <table>
        <thead>
            <tr>
                <th>Descri√ß√£o</th>
                <th style="width: 80px;">Qtd</th>
                <th style="width: 150px;">C√≥d Gold</th>
            </tr>
        </thead>
        <tbody id="tabela-pecas">
            </tbody>
    </table>

    <div class="section">RESUMO DE M√ÉO DE OBRA</div>
    <table>
        <thead>
            <tr>
                <th>Descri√ß√£o</th>
                <th style="width: 80px;">Qtd (hs)</th>
                <th style="width: 150px;">C√≥d Gold</th>
            </tr>
        </thead>
        <tbody>
            <tr><td>DESMONTAGEM DO EQUIPAMENTO</td><td><input type="number" class="hr-input" placeholder="Ex:8" oninput="calcularTotal()"></td><td>SVG1192</td></tr>
            <tr><td>DESCONTAMINACAO DE PECAS</td><td><input type="number" class="hr-input" placeholder="Ex:3" oninput="calcularTotal()"></td><td>SVG1193</td></tr>
            <tr><td>ANALISE E PERITAGEM EM PECAS</td><td><input type="number" class="hr-input" placeholder="Ex:2" oninput="calcularTotal()"></td><td>SVG1194</td></tr>
            <tr><td>MONTAGEM E AJUSTE DE FOLGAS</td><td><input type="number" class="hr-input" placeholder="Ex:20" oninput="calcularTotal()"></td><td>SVG1210</td></tr>
            <tr><td>TESTES FINAIS DO EQUIPAMENTO</td><td><input type="number" class="hr-input" placeholder="Ex:1" oninput="calcularTotal()"></td><td>SVG1200</td></tr>
            <tr><td>PINTURA FINAL</td><td><input type="number" class="hr-input" placeholder="Ex:4" oninput="calcularTotal()"></td><td>SVG1174</td></tr>
            <tr><td>SACAR ACOPLAMENTOS</td><td><input type="number" class="hr-input" placeholder="Ex:2" oninput="calcularTotal()"></td><td>SVG1262</td></tr>
        </tbody>
        <tfoot>
            <tr class="total-row">
                <td style="text-align: right; padding-right: 15px;">TOTAL DE HORAS T√âCNICAS:</td>
                <td id="total-horas" style="text-align: center;">40</td>
                <td></td>
            </tr>
        </tfoot>
    </table>
<!-- conclusoes -->
    <div class="conclusoes-title">CONCLUS√ïES</div>
    <div class="conclusoes-texto">
    <textarea rows="6" style="width: 100%;" placeholder="Descrever as conclus√µes referente as manuten√ß√µes necess√°rias para execu√ß√£o do servi√ßo, sempre observando as pe√ßas que n√£o s√£o de desgaste e necessitam ser trocadas"></textarea>
</div>

    <div class="no-print">
        <button onclick="window.print()">GERAR RELAT√ìRIO / PDF</button>
    </div>

    <script>
        // 1. DATA ATUAL AUTOM√ÅTICA
        function configurarDataAtual() {
            const data = new Date();
            const dia = String(data.getDate()).padStart(2, '0');
            const mes = String(data.getMonth() + 1).padStart(2, '0');
            const ano = data.getFullYear();
            document.getElementById('data-atual').innerText = `${dia}/${mes}/${ano}`;
        }

        // 2. TABELA DE PE√áAS DIN√ÇMICA
        const corpoTabelaPecas = document.getElementById('tabela-pecas');
        function criarLinhaPeca() {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td><input type="text" class="input-peca" placeholder="Digite para adicionar pe√ßa..."></td>
                <td><input type="number" placeholder="0"></td>
                <td><input type="text" placeholder="C√≥d Gold"></td>
            `;
            // Listener para criar nova linha quando a √∫ltima for preenchida
            tr.querySelector('.input-peca').addEventListener('input', function() {
                const inputs = document.querySelectorAll('.input-peca');
                if (inputs[inputs.length - 1].value.trim() !== "") {
                    criarLinhaPeca();
                }
            });
            corpoTabelaPecas.appendChild(tr);
        }

        // 3. C√ÅLCULO DE HORAS
        function calcularTotal() {
            let inputs = document.getElementsByClassName('hr-input');
            let total = 0;
            for (let i = 0; i < inputs.length; i++) {
                let valor = parseFloat(inputs[i].value);
                if (!isNaN(valor)) total += valor;
            }
            document.getElementById('total-horas').innerText = total;
        }

        // 4. PREVIEW DE FOTOS
        function previewFotos(event) {
            const container = document.getElementById('container-fotos');
            const files = event.target.files;
            for (let i = 0; i < files.length; i++) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const div = document.createElement('div');
                    div.className = 'foto-item';
                    div.innerHTML = `
                        <img src="${e.target.result}" class="foto-preview">
                        <textarea class="obs-foto" rows="2" placeholder="Observa√ß√£o da imagem..."></textarea>
                    `;
                    container.appendChild(div);
                }
                reader.readAsDataURL(files[i]);
            }
        }

        // INICIALIZA√á√ÉO AO CARREGAR
        window.onload = function() {
            configurarDataAtual();
            calcularTotal();
            // Inicia com as 3 linhas padr√£o
            for(let i=0; i<3; i++) { criarLinhaPeca(); }
        };
    </script>
</body>
</html>
